<!DOCTYPE html>
<html>
<head>
  <title>Office Project Records</title>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    input { padding: 8px; width: 300px; }
    button { padding: 8px; }
    .card { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
  </style>
</head>
<body>

<h2>Office Project Search</h2>

<input type="text" id="searchInput" placeholder="Search by file no, case no, address...">
<button onclick="searchCSV()">Search</button>

<div id="output"></div>

<script>
async function searchCSV() {
  const response = await fetch("File Record N9.csv");
  const csvText = await response.text();

  Papa.parse(csvText, {
    header: true,
    skipEmptyLines: true,
    complete: function(results) {
      const data = results.data;
      const searchValue = document.getElementById("searchInput").value.toLowerCase();
      let resultHTML = "";

      data.forEach(row => {
        const combined = JSON.stringify(row).toLowerCase();

        if (combined.includes(searchValue)) {
          resultHTML += `
            <div class="card">
              <p><strong>File No:</strong> ${row["FILE NUMBER"] || ""}</p>
              <p><strong>Inward No:</strong> ${row["INWARD NUMBER "] || ""}</p>
              <p><strong>Case No:</strong> ${row["CASE NUMBER"] || ""}</p>
              <p><strong>TP Scheme:</strong> ${row["T.P SCHEME NUMBER"] || ""}</p>
              <p><strong>Final Plot:</strong> ${row["FINAL PLOT NUMBER"] || ""}</p>
              <p><strong>Address:</strong> ${row["ADDRESS"] || ""}</p>
              <p><strong>Architect:</strong> ${row["ARCH./ENGG. NAME"] || ""}</p>
            </div>
          `;
        }
      });

      document.getElementById("output").innerHTML =
        resultHTML || "<p>No results found</p>";
    }
  });
}
</script>

</body>
</html>
